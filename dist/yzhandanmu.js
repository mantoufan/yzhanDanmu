!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.YZhanDanMu=e():t.YZhanDanMu=e()}(this,(function(){return function(){var t={714:function(){"function"!=typeof Object.assign&&(Object.assign=function(t){"use strict";if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])}return e})}},e={};function i(n){var o=e[n];if(void 0!==o)return o.exports;var r=e[n]={exports:{}};return t[n](r,r.exports,i),r.exports}i.d=function(t,e){for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};var n={};return function(){"use strict";function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}i.d(n,{default:function(){return s}}),i(714);var e=function(){function e(t){var i=t.top,n=t.bottom,o=t.id;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Object.assign(this,{_oid:0,s:{p:[],o:[]},v:{top:i,bottom:n,id:o}})}var i,n;return i=e,n=[{key:"id",value:function(t){return null===t?null:(void 0===t._oid&&(t._oid=this._oid++),t._oid)}},{key:"q",value:function(t,e,i){for(var n=0;n<t.length;n++){var o=Math.min(t[n][0],t[n][1]),r=Math.max(t[n][0],t[n][1]),a=[],s=void 0;for(var u in e[o]=2,e[r]=1,e)u>=o&&u<=r&&a.push([u,e[u]]);if(a.length>26)return!1;if(t[n][1]>=t[n][0]){for(var f,l=0;f=a[l],l<a.length;l++)if(2==f[1])s=f[0];else if(1==f[1]&&s&&f[0]-s>=i)return 0|s}else for(var h,c=a.length;h=a[c],c--;)if(1==h[1])s=h[0];else if(2==h[1]&&s&&s-h[0]>=i)return s-i|0}return!1}},{key:"bpi",value:function(t,e,i){return t[e]||(t[e]=Object.create(null)),t[e][i]||(t[e][i]=Object.create(null)),t}},{key:"add",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.prior,n=void 0===i?"time":i,o=this.bpi,r=this.q,a=this.s,s=this.v,u=s.id,f=this.id(t),l=!1,h=t.offsetHeight,c=0,d="time"===n?3:1;!1===l&&c<d;)a.p=o(a.p,u,c),h=(l=r([[s.top,s.bottom]],a.p[u][c],h))+h,c++;if(!1!==l){c--;var p=a.p[u][c][l],v=a.p[u][c][h];a.p[u][c][l]=p&&2==p?3:1,a.p[u][c][h]=v&&1==v?3:2,a.o[f]=[l,h,c,u]}return l}},{key:"remove",value:function(t){var e=this.s,i=this.id(t);if(void 0!==e.o[i]){var n=e.o[i],o=n[0],r=n[1],a=n[2],s=n[3],u=e.p[s][a][o],f=e.p[s][a][r];delete e.o[i],u&&(3===u?e.p[s][a][o]=2:1===u&&delete e.p[s][a][o]),f&&(3===f?e.p[s][a][r]=1:2===f&&delete e.p[s][a][r])}}}],n&&t(i.prototype,n),e}();function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var r=function(){return Math.random().toString(36).slice(-6)},a=function(t,e,i){var n=t[e];t[e]=t[i],t[i]=n},s=function(){function t(i){var n=i.p;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),void 0===n.id&&(n.id="yzhan_p_"+r()),0===n.offsetHeight&&(n.style.height="300px");var o=new e({top:0,bottom:n.offsetHeight,id:n.id});Object.assign(this,{p:n,mtfWay:o,cssList:{danmu:"yzhan-danmu",animation:{rightToLeft:"yzhan-right-to-left"}},queueDelay:[],queueIn:[],queueOut:[],callback:function(){for(var t=this.p,e=this.add,i=this.queueIn,n=this.queueOut,r=this.queueDelay,s=Date.now(),u=i.length,f=u;f--;)i[f].expireIn<s&&(o.remove(i[f]),n.push(i[f]),a(i,f,--u));i.length=u;for(var l=u=n.length;l--;)n[l].expireOut<s&&(t.removeChild(n[l]),a(n,l,--u));n.length=u,r.length&&(e.apply(this,r.shift()),r.length>50&&r.splice(1,r.length-25)),this.requestId=requestAnimationFrame(this.callback)}}),this.callback=this.callback.bind(this),this.requestId=requestAnimationFrame(this.callback),this.initCSS(n.id,n.offsetWidth)}var i,n;return i=t,n=[{key:"initCSS",value:function(t,e){var i=this.cssList,n=document.createElement("style");document.head.appendChild(n);var o=i.danmu,r=i.animation.rightToLeft;n.sheet.insertRule("#".concat(t," { position: relative }"),0),n.sheet.insertRule(".".concat(o," { position: absolute; top: -1000vh; right: 0; animation-timing-function: linear; animation-fill-mode: forwards; }"),0),n.sheet.insertRule("@keyframes ".concat(r," { from { transform: translateX(100%); } to { transform: translateX(-").concat(e,"px); } }"),0)}},{key:"add",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.p,n=this.mtfWay,o=this.cssList,a=this.queueDelay,s=this.queueIn,u=e.duration,f=void 0===u?"5000":u,l=e.prior,h=void 0===l?"time":l,c=e.speed;if(t&&i){void 0===t.id&&(t.id="yzhan_d_"+r());var d=o.danmu,p=o.animation.rightToLeft;t.className=d,i.appendChild(t);var v=n.add(t,{prior:h});if(!1===v){if("nooverlap"===h?a.push([t,e]):"nooverlap-highest"===h&&a.unshift([t,e]),"time"!==h)return void i.removeChild(t);v=0}c&&(f=(i.offsetWidth+t.offsetWidth)/c|0),t.expireIn=Date.now()+(f*t.offsetWidth/(t.offsetWidth+i.offsetWidth)|0),t.expireOut=Date.now()+f,s.push(t),t.style.top=v+"px",t.style.animationDuration=f+"ms",t.style.animationName=p}}},{key:"destroy",value:function(){cancelAnimationFrame(this.requestId);for(var t=this.p.children.length;t--;)this.p.removeChild(this.p.children[t])}}],n&&o(i.prototype,n),t}()}(),n.default}()}));